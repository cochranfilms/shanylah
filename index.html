<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Cochran Films — Shanylah Sainvil Onboarding</title>
<meta name="description" content="Onboarding guide for Shanylah Sainvil — Cochran Films procedures, expectations, and quick links.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
/* Brand palette - Light theme */
:root{
  --cf-gold:#f5af00;
  --cf-gold-light:#ffd700;
  --cf-gold-dark:#e09a00;
  --cf-black:#1a1a1a;
  --cf-white:#ffffff;
  --cf-gray:#6b7280;
  --cf-light-gray:#f8fafc;
  --cf-blue:#3b82f6;
  --cf-purple:#8b5cf6;
  --cf-pink:#ec4899;
  --cf-green:#10b981;
  --max:1200px;
  --shadow:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);
  --shadow-lg:0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04);
}

*{box-sizing:border-box}
html,body{
  margin:0;padding:0;
  background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);
  color:var(--cf-black);
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  line-height:1.6;
  min-height:100vh;
}

h1,h2,h3{font-family:Montserrat,Inter,sans-serif;margin:0 0 16px;font-weight:700}
h1{font-size:clamp(32px,5vw,48px);letter-spacing:-0.02em;background:linear-gradient(135deg,var(--cf-gold),var(--cf-purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
h2{font-size:clamp(24px,3vw,32px);color:var(--cf-black);position:relative}
h2::after{content:'';position:absolute;bottom:-8px;left:0;width:60px;height:4px;background:linear-gradient(90deg,var(--cf-gold),var(--cf-pink));border-radius:2px}
h3{font-size:20px;color:var(--cf-black)}

p{margin:0 0 16px;color:var(--cf-gray)}
img{max-width:100%;height:auto}

a{color:var(--cf-blue);text-decoration:none;border-bottom:2px solid transparent;transition:all 0.3s ease}
a:hover{color:var(--cf-gold);border-bottom-color:var(--cf-gold);transform:translateY(-1px)}

.wrap{max-width:var(--max);margin:0 auto;padding:32px 24px}

.hero{
  position:relative;
  padding:60px 24px 40px;
  background:linear-gradient(135deg,var(--cf-white) 0%,var(--cf-light-gray) 100%);
  border-radius:24px;
  margin-bottom:32px;
  box-shadow:var(--shadow-lg);
  overflow:hidden;
}

.hero::before{
  content:'';
  position:absolute;
  top:0;left:0;right:0;bottom:0;
  background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="%23f5af00" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="%238b5cf6" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="%23ec4899" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
  opacity:0.3;
}

.brand{
  display:flex;
  align-items:center;
  gap:20px;
  position:relative;
  z-index:2;
}

.brand img{
  width:64px;
  height:auto;
  filter:drop-shadow(0 4px 8px rgba(0,0,0,0.1));
  animation:float 3s ease-in-out infinite;
}

@keyframes float{
  0%,100%{transform:translateY(0px)}
  50%{transform:translateY(-5px)}
}

.tag{
  display:inline-block;
  background:linear-gradient(135deg,var(--cf-gold),var(--cf-gold-light));
  color:var(--cf-white);
  padding:8px 16px;
  border-radius:50px;
  font-size:14px;
  font-weight:600;
  letter-spacing:0.5px;
  margin:12px 0;
  box-shadow:var(--shadow);
  animation:pulse 2s infinite;
}

@keyframes pulse{
  0%,100%{transform:scale(1)}
  50%{transform:scale(1.05)}
}

.intro{
  color:var(--cf-gray);
  max-width:900px;
  font-size:18px;
  line-height:1.7;
  position:relative;
  z-index:2;
}

.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:24px;margin-top:32px}

.card{
  grid-column:span 12;
  background:var(--cf-white);
  border:1px solid rgba(0,0,0,0.05);
  border-radius:20px;
  padding:28px 24px;
  box-shadow:var(--shadow);
  transition:all 0.3s ease;
  position:relative;
  overflow:hidden;
}

.card::before{
  content:'';
  position:absolute;
  top:0;left:0;right:0;
  height:4px;
  background:linear-gradient(90deg,var(--cf-gold),var(--cf-pink),var(--cf-purple));
}

.card:hover{
  transform:translateY(-4px);
  box-shadow:var(--shadow-lg);
}

@media(min-width:900px){
  .card{padding:32px 28px}
  .span-6{grid-column:span 6}
  .span-4{grid-column:span 4}
  .span-8{grid-column:span 8}
}

.card h3{
  margin-bottom:12px;
  font-size:20px;
  color:var(--cf-black);
}

.muted{color:var(--cf-gray)}

.list{
  margin:12px 0 0;
  padding-left:20px;
}

.list li{
  margin:8px 0;
  color:var(--cf-gray);
  position:relative;
}

.list li::marker{
  color:var(--cf-gold);
  font-weight:bold;
}

.quick-links{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  margin-top:16px;
}

.btn{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:12px 20px;
  border-radius:12px;
  border:2px solid transparent;
  background:var(--cf-white);
  color:var(--cf-black);
  font-weight:600;
  text-decoration:none;
  transition:all 0.3s ease;
  box-shadow:var(--shadow);
  position:relative;
  overflow:hidden;
}

.btn::before{
  content:'';
  position:absolute;
  top:0;left:-100%;
  width:100%;height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.4),transparent);
  transition:left 0.5s;
}

.btn:hover::before{left:100%}

.btn:hover{
  transform:translateY(-2px);
  box-shadow:var(--shadow-lg);
  border-color:var(--cf-gold);
}

.btn.gold{
  background:linear-gradient(135deg,var(--cf-gold),var(--cf-gold-light));
  color:var(--cf-white);
  border-color:var(--cf-gold);
}

.btn.gold:hover{
  background:linear-gradient(135deg,var(--cf-gold-dark),var(--cf-gold));
  transform:translateY(-2px) scale(1.02);
}

.footer{
  padding:40px 24px;
  color:var(--cf-gray);
  text-align:center;
  border-top:1px solid rgba(0,0,0,0.1);
  margin-top:40px;
  background:var(--cf-white);
  border-radius:20px 20px 0 0;
}

.kicker{font-size:14px;color:var(--cf-gray)}

.two-col{
  display:grid;
  grid-template-columns:1fr;
  gap:20px;
}

@media(min-width:900px){
  .two-col{grid-template-columns:1.1fr .9fr}
}

.drive-embed{
  width:100%;
  height:560px;
  border:2px solid rgba(0,0,0,0.1);
  border-radius:16px;
  background:var(--cf-white);
  box-shadow:var(--shadow);
}

.viewer{
  display:grid;
  gap:16px;
}

.controls{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  align-items:center;
}

.field{
  flex:1 1 320px;
  padding:12px 16px;
  border-radius:12px;
  border:2px solid rgba(0,0,0,0.1);
  background:var(--cf-white);
  color:var(--cf-black);
  font-size:16px;
  transition:border-color 0.3s ease;
}

.field:focus{
  outline:none;
  border-color:var(--cf-gold);
  box-shadow:0 0 0 3px rgba(245,175,0,0.1);
}

.viewer-iframe{
  width:100%;
  height:620px;
  border:2px solid rgba(0,0,0,0.1);
  border-radius:16px;
  background:var(--cf-white);
  box-shadow:var(--shadow);
}

.apps-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:24px;
}

.app-embed{
  display:grid;
  gap:16px;
}

.toolbar{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  align-items:center;
  padding:16px;
  background:var(--cf-light-gray);
  border-radius:12px;
}

.toolbar .title{
  font-weight:700;
  margin-right:auto;
  color:var(--cf-black);
  font-size:18px;
}

.app-frame{
  width:100%;
  height:860px;
  border:2px solid rgba(0,0,0,0.1);
  border-radius:16px;
  background:var(--cf-white);
  box-shadow:var(--shadow);
}

.hint{
  font-size:14px;
  color:var(--cf-gray);
  font-style:italic;
}

.fullscreen{
  position:fixed;
  inset:0;
  width:100vw;
  height:100vh;
  background:var(--cf-white);
  padding:20px;
  margin:0;
  z-index:9999;
  border-radius:0;
}

.fullscreen .app-frame{
  height:calc(100vh - 100px);
}

/* Scroll animations */
@keyframes slideInUp{
  from{
    opacity:0;
    transform:translateY(30px);
  }
  to{
    opacity:1;
    transform:translateY(0);
  }
}

.card{
  animation:slideInUp 0.6s ease-out;
}

.card:nth-child(2){animation-delay:0.1s}
.card:nth-child(3){animation-delay:0.2s}
.card:nth-child(4){animation-delay:0.3s}
.card:nth-child(5){animation-delay:0.4s}
</style>
</head>
<body>
  <header class="hero">
    <div class="wrap">
      <div class="brand">
        <img src="CF_Logo_White2025.png" alt="Cochran Films logo" onerror="this.src='CF_Logo_Black2025.png'">
        <div>
          <div class="tag">🎬 Welcome to the Team! 🎬</div>
          <h1>Hey Shanylah! You're officially part of the Cochran Films family! 🚀</h1>
          <p class="intro">This is your personal command center — everything you need to rock your role as our amazing assistant. Bookmark this page because we're constantly adding new tools and resources to help you succeed and grow with us!</p>
        </div>
      </div>
      <div class="quick-links" style="margin-top:14px">
        <a class="btn gold" href="https://drive.google.com/drive/folders/1wPNOT-M9-vA4Uep6pSM3bq3qTOMYEQUC?usp=drive_link" target="_blank" rel="noopener">Team Files (Read)</a>
        <a class="btn" href="https://drive.google.com/drive/folders/1-rDCCbGelvTEEgxkfv68b_aMDkSXRnyq?usp=drive_link" target="_blank" rel="noopener">Your Drive Folder (Upload)</a>
        <a class="btn" href="https://landing.cochranfilms.com/forms-hub.html" target="_blank" rel="noopener">Discovery & Media Forms</a>
        <a class="btn" href="https://www.cochranfilms.com/" target="_blank" rel="noopener">Cochran Films Website</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="grid">
      <article class="card span-8">
        <h2>🎉 1) Welcome + What You've Already Completed</h2>
        <ul class="list">
          <li>Reviewed and signed your Assistant Contract ✅</li>
          <li>Reviewed the Cochran Films SOP ✅</li>
          <li>Received and reviewed Brand Guidelines ✅</li>
          <li>Granted Admin access to Calendly and HubSpot ✅</li>
        </ul>
        <p class="muted">Great start — you’re cleared to begin your active role.</p>
      </article>

      <aside class="card span-4">
        <h3>⚡ Quick Access</h3>
        <div class="quick-links">
          <a class="btn" href="https://www.hubspot.com/" target="_blank" rel="noopener">HubSpot</a>
          <a class="btn" href="https://calendly.com/" target="_blank" rel="noopener">Calendly</a>
          <a class="btn" href="https://trello.com/" target="_blank" rel="noopener">Trello</a>
          <a class="btn" href="https://www.waveapps.com/" target="_blank" rel="noopener">Wave</a>
          <a class="btn" href="https://www.linkedin.com/company/cochranfilms" target="_blank" rel="noopener">LinkedIn</a>
        </div>
      </aside>

      <article class="card span-12">
        <h2>🎬 2) Overview of Cochran Films</h2>
        <p>Cochran Films LLC is a full-stack media powerhouse based in Georgia, specializing in high-end video production, branding, web development, content strategy, on-site photo printing, and AI-driven systems via our sister brand Marketing Mousetrap Agency. Founded by Cody Cochran, we focus on quality, innovation, client satisfaction, and empowering stories through film, education, and technology.</p>
        <div class="two-col">
          <div>
            <h3>What We Do</h3>
            <ul class="list">
              <li>Media Production: film, promos, docs, podcasts, commercials</li>
              <li>Business Tools: automated invoicing, client portals, dashboards</li>
              <li>Branding & Web: logos, websites, SEO, automation</li>
              <li>Community & Education: Course Creator Academy, CCA Critiques</li>
            </ul>
          </div>
          <div>
            <h3>Key Values</h3>
            <ul class="list">
              <li>Trust</li>
              <li>Loyalty</li>
              <li>Innovation</li>
              <li>Family</li>
              <li>Professionalism</li>
            </ul>
          </div>
        </div>
      </article>

      <article class="card span-6">
        <h2>💼 3) Your Role as an Assistant</h2>
        <h3>Primary Responsibilities</h3>
        <ul class="list">
          <li>Email sorting and response</li>
          <li>Scheduling via Calendly</li>
          <li>Managing client info and pipeline in HubSpot</li>
          <li>Internal file organization (Google Drive / G Suite)</li>
          <li>Weekly check-ins and updates with Cody</li>
        </ul>
        <h3>Expanded Capabilities (Next)</h3>
        <ul class="list">
          <li>Access to Cody’s email account (view/sort/send on behalf)</li>
          <li>Access to Cody’s LinkedIn for lead messaging and research</li>
        </ul>
        <h3>Success Looks Like</h3>
        <ul class="list">
          <li>Timely, detail‑oriented task completion</li>
          <li>Reachable during weekday business hours</li>
          <li>Proactive check-ins for updates or shifts</li>
          <li>Client confidentiality and brand professionalism</li>
        </ul>
      </article>

      <article class="card span-6">
        <h2>📅 4) Calendly — Overview</h2>
        <p>Calendly powers discovery calls, onboarding meetings, and consultations.</p>
        <h3>Your Use</h3>
        <ul class="list">
          <li>Monitor bookings and notify Cody of new appointments</li>
          <li>Adjust availability or meeting types as needed</li>
          <li>Review meeting notes/form data prior to calls</li>
        </ul>
        <h3>Helpful Features</h3>
        <ul class="list">
          <li>Google Calendar sync</li>
          <li>Meeting buffers and time zones</li>
          <li>Form integration for client info</li>
        </ul>
      </article>

      <article class="card span-6">
        <h2>🎯 5) HubSpot — Overview</h2>
        <p>HubSpot is our CRM to manage leads, clients, templates, and the pipeline.</p>
        <h3>Your Use</h3>
        <ul class="list">
          <li>Track new contacts and deal status</li>
          <li>Use email templates for outreach or follow‑ups</li>
          <li>Log notes and update tasks after conversations</li>
        </ul>
        <h3>Helpful Features</h3>
        <ul class="list">
          <li>Contact timeline history</li>
          <li>Pipeline views and stages</li>
          <li>Automation: reminders, follow‑ups, internal alerts</li>
        </ul>
      </article>

      <article class="card span-6">
        <h2>🛠️ 6) Tools You'll Use Often</h2>
        <ul class="list">
          <li>Gmail: inquiries and replies</li>
          <li>LinkedIn (Cody’s): leads and client data — <a href="https://www.linkedin.com/company/cochranfilms" target="_blank" rel="noopener">open</a></li>
          <li>Google Calendar: events, shoots, calls</li>
          <li>Google Drive: assets, documents, brand kits</li>
          <li>Trello or Sheets: task tracking — <a href="https://trello.com/" target="_blank" rel="noopener">open</a></li>
          <li>WaveApps: invoices and reminders — <a href="https://www.waveapps.com/" target="_blank" rel="noopener">open</a></li>
          <li>Zoom / FaceTime: weekly check‑ins</li>
        </ul>
      </article>

      <article class="card span-12">
        <h2>🔗 7) Quick Links</h2>
        <div class="quick-links">
          <a class="btn" href="https://landing.cochranfilms.com/forms-hub.html" target="_blank" rel="noopener">Discovery Call Booking</a>
          <a class="btn" href="https://landing.cochranfilms.com/forms-hub.html" target="_blank" rel="noopener">Media Inquiry Form</a>
          <a class="btn" href="https://www.cochranfilms.com/" target="_blank" rel="noopener">Cochran Films Website</a>
          <a class="btn" href="https://www.cochranfilms.com/portfolio" target="_blank" rel="noopener">Portfolio</a>
          <a class="btn" href="https://www.instagram.com/cochran.films/" target="_blank" rel="noopener">Instagram</a>
          <a class="btn" href="https://www.youtube.com/@cochranfilmsllc" target="_blank" rel="noopener">YouTube</a>
        </div>
      </article>

      <article class="card span-12">
        <h2>🎯 8) First Week Goals</h2>
        <ul class="list">
          <li>Get familiar with the HubSpot dashboard — <a href="https://www.hubspot.com/" target="_blank" rel="noopener">hubspot.com</a></li>
          <li>Log into Calendly and view upcoming bookings — <a href="https://calendly.com/" target="_blank" rel="noopener">calendly.com</a></li>
          <li>Review brand guidelines — <a href="https://drive.google.com/file/d/17mSv4xvh9IDfNdupTEB8YvJImgNwy0BU/view?usp=sharing" target="_blank" rel="noopener">open</a></li>
          <li>Get access to Gmail + LinkedIn</li>
          <li>One‑on‑one with Cody — Already done ✅</li>
          <li>Bookmark all important links and logins</li>
        </ul>
      </article>
    </section>

    <section class="card" style="margin-top:18px">
      <h3>📁 File Handoff</h3>
      <p>
        • Team resources live here: <a href="https://drive.google.com/drive/folders/1wPNOT-M9-vA4Uep6pSM3bq3qTOMYEQUC?usp=drive_link" target="_blank" rel="noopener">Cochran Films Internal Drive</a><br>
        • Upload your work here: <a href="https://drive.google.com/drive/folders/1-rDCCbGelvTEEgxkfv68b_aMDkSXRnyq?usp=drive_link" target="_blank" rel="noopener">Shanylah Personal Folder</a>
      </p>
      <p class="kicker">We’ll add more shortcuts (SOPs, templates, scripts) as needed.</p>
    </section>

    <section class="grid" style="margin-top:18px" aria-label="Embedded Drive Folders">
      <article class="card span-6">
        <h3>Team Files — Inline View</h3>
        <iframe class="drive-embed" src="https://drive.google.com/embeddedfolderview?id=1wPNOT-M9-vA4Uep6pSM3bq3qTOMYEQUC#grid" title="Cochran Films Internal Drive"></iframe>
        <p class="kicker">Read‑only preview. If access is restricted, set folder sharing to “Anyone with the link: Viewer”.</p>
      </article>
      <article class="card span-6">
        <h3>Your Uploads — Inline View</h3>
        <iframe class="drive-embed" src="https://drive.google.com/embeddedfolderview?id=1-rDCCbGelvTEEgxkfv68b_aMDkSXRnyq#list" title="Shanylah Personal Folder"></iframe>
        <p class="kicker">Use “Open in Drive” inside the frame to upload. In‑page uploads would require Google Picker API.</p>
      </article>
    </section>

    <section class="card" style="margin-top:18px">
      <h2>👀 Inline File Viewer</h2>
      <p class="muted">Paste any Google Drive link (Docs, Sheets, Slides, PDFs, images, videos) and preview it here. Works with items shared to “Anyone with the link”.</p>
      <div class="viewer">
        <div class="controls">
          <input id="driveUrl" class="field" type="url" inputmode="url" placeholder="Paste a Google Drive link…">
          <button id="previewBtn" class="btn gold" type="button">Preview</button>
          <a id="openBtn" class="btn" href="#" target="_blank" rel="noopener">Open in Drive</a>
          <a id="downloadBtn" class="btn" href="#" target="_blank" rel="noopener">Download</a>
          <a id="sampleBtn" class="btn" href="#" role="button">Try sample</a>
        </div>
        <iframe id="viewerFrame" class="viewer-iframe" title="Drive file preview"></iframe>
      </div>
    </section>

    <section class="card" style="margin-top:18px">
      <h2>🚀 Unified Workspace</h2>
      <p class="muted">Quick access to key platforms. Most services block iframe embedding for security, so we've provided direct links with embedded Calendly (which works).</p>
      <div class="apps-grid">
        <div class="app-embed" data-name="Calendly" data-url="https://calendly.com/">
          <div class="toolbar">
            <div class="title">Calendly (Embedded)</div>
            <button class="btn gold" data-action="refresh" type="button">Refresh</button>
            <button class="btn" data-action="fullscreen" type="button">Fullscreen</button>
            <a class="btn" data-action="open" href="https://calendly.com/" target="_blank" rel="noopener">Open in New Tab</a>
          </div>
          <iframe class="app-frame" title="Calendly"></iframe>
          <div class="hint">✅ Calendly works embedded - log in and manage bookings here.</div>
        </div>

        <div class="app-embed">
          <div class="toolbar">
            <div class="title">Other Platforms (Direct Links)</div>
          </div>
          <div style="padding: 20px; background: rgba(255,255,255,.02); border-radius: 8px; border: 1px solid rgba(255,255,255,.08);">
            <div class="quick-links">
              <a class="btn gold" href="https://app.hubspot.com/" target="_blank" rel="noopener">HubSpot CRM</a>
              <a class="btn" href="https://trello.com/" target="_blank" rel="noopener">Trello Boards</a>
              <a class="btn" href="https://www.linkedin.com/company/cochranfilms" target="_blank" rel="noopener">LinkedIn Company</a>
              <a class="btn" href="https://www.waveapps.com/" target="_blank" rel="noopener">Wave Invoicing</a>
              <a class="btn" href="https://mail.google.com/" target="_blank" rel="noopener">Gmail</a>
              <a class="btn" href="https://calendar.google.com/" target="_blank" rel="noopener">Google Calendar</a>
            </div>
            <p class="hint" style="margin-top: 12px;">These platforms block iframe embedding for security. Click any button to open in a new tab.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="card" style="margin-top:18px">
      <h2>📖 Complete Onboarding Guide</h2>
      <p class="muted">Your comprehensive reference guide with all the details, links, and resources you need to succeed.</p>
      <div class="quick-links" style="margin-bottom:16px">
        <a class="btn gold" href="README.md" target="_blank" rel="noopener">📄 View Full README</a>
        <a class="btn" href="https://github.com/cochranfilms/shanylah" target="_blank" rel="noopener">🔗 GitHub Repository</a>
      </div>
      <iframe class="viewer-iframe" src="README.md" title="Complete Onboarding Guide" style="height:600px;"></iframe>
    </section>
  </main>

  <footer class="footer">
    <img src="CF_Logo_White2025.png" alt="Cochran Films" width="44" height="44" style="opacity:.9" onerror="this.src='CF_Logo_Black2025.png'">
    <div class="kicker">©2025 Cochran Films LLC • Stories that tell themselves</div>
  </footer>

<script>
(function(){
  const input = document.getElementById('driveUrl');
  const previewBtn = document.getElementById('previewBtn');
  const openBtn = document.getElementById('openBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  const frame = document.getElementById('viewerFrame');
  const sampleBtn = document.getElementById('sampleBtn');

  const SAMPLE_ID = '17mSv4xvh9IDfNdupTEB8YvJImgNwy0BU';

  function extractIdAndKind(rawUrl){
    if(!rawUrl) return null;
    try{ rawUrl = rawUrl.trim(); }catch(e){ return null; }
    const url = new URL(rawUrl);
    const host = url.hostname;
    const path = url.pathname;
    const searchParams = url.searchParams;

    const idFromD = /\/d\/([a-zA-Z0-9_-]{10,})/.exec(path);
    const idFromQuery = searchParams.get('id');
    const id = (idFromD && idFromD[1]) || idFromQuery || '';
    if(!id) return null;

    let kind = 'file';
    if(host.includes('docs.google.com')){
      if(path.includes('/document/')) kind = 'document';
      else if(path.includes('/spreadsheets/')) kind = 'spreadsheet';
      else if(path.includes('/presentation/')) kind = 'presentation';
    }
    return { id, kind };
  }

  function buildPreviewUrl(info){
    if(!info) return '';
    const id = info.id;
    switch(info.kind){
      case 'document': return `https://docs.google.com/document/d/${id}/preview`;
      case 'spreadsheet': return `https://docs.google.com/spreadsheets/d/${id}/preview`;
      case 'presentation': return `https://docs.google.com/presentation/d/${id}/preview`;
      default: return `https://drive.google.com/file/d/${id}/preview`;
    }
  }

  function buildOpenUrl(info){
    if(!info) return '#';
    const id = info.id;
    switch(info.kind){
      case 'document': return `https://docs.google.com/document/d/${id}/view`;
      case 'spreadsheet': return `https://docs.google.com/spreadsheets/d/${id}/view`;
      case 'presentation': return `https://docs.google.com/presentation/d/${id}/view`;
      default: return `https://drive.google.com/file/d/${id}/view`;
    }
  }

  function buildDownloadUrl(info){
    if(!info) return '#';
    const id = info.id;
    switch(info.kind){
      case 'document': return `https://docs.google.com/document/d/${id}/export?format=pdf`;
      case 'spreadsheet': return `https://docs.google.com/spreadsheets/d/${id}/export?format=pdf`;
      case 'presentation': return `https://docs.google.com/presentation/d/${id}/export/pdf`;
      default: return `https://drive.google.com/uc?export=download&id=${id}`;
    }
  }

  function preview(url){
    const info = extractIdAndKind(url);
    if(!info){ alert('Please paste a valid Google Drive link.'); return; }
    const previewUrl = buildPreviewUrl(info);
    const openUrl = buildOpenUrl(info);
    const downloadUrl = buildDownloadUrl(info);
    frame.src = previewUrl;
    openBtn.href = openUrl;
    downloadBtn.href = downloadUrl;
  }

  previewBtn.addEventListener('click', () => preview(input.value));
  input.addEventListener('keydown', (e) => { if(e.key === 'Enter'){ e.preventDefault(); preview(input.value); } });
  sampleBtn.addEventListener('click', (e) => { e.preventDefault(); input.value = `https://drive.google.com/file/d/${SAMPLE_ID}/view?usp=sharing`; preview(input.value); });
})();

// Initialize app iframes
(function(){
  const blocks = document.querySelectorAll('.app-embed');
  blocks.forEach(block => {
    const url = block.getAttribute('data-url');
    const frame = block.querySelector('iframe');
    const openBtn = block.querySelector('[data-action="open"]');
    const refreshBtn = block.querySelector('[data-action="refresh"]');
    const fullscreenBtn = block.querySelector('[data-action="fullscreen"]');
    if(frame) frame.src = url;
    if(openBtn) openBtn.href = url.replace(/login$/,'');
    if(refreshBtn) refreshBtn.addEventListener('click', ()=>{ if(frame) frame.src = frame.src; });
    if(fullscreenBtn) fullscreenBtn.addEventListener('click', ()=>{
      block.classList.toggle('fullscreen');
      // Scroll to top when entering fullscreen
      if(block.classList.contains('fullscreen')) window.scrollTo({top:0,behavior:'smooth'});
    });
  });
})();
</script>

</body>
</html>


